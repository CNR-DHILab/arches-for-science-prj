{% extends "views/report-templates/default.htm" %} 
{% load i18n %} 
{% block report %}

{% block body %}
<div class="afs-report-section" data-bind="foreach: {data: data().sections, as: section, noChildContext: true}">
    <h2 class="afs-report-section-title"><i data-bind="click: function() {toggleVisibility(visible[section.title])}" class="fa fa-angle-double-right toggle"></i> <span data-bind="text: section.title"></span></h2>
    
    <!-- Collapsible content -->
    <div data-bind="visible: visible[section.title]" class="afs-report-collapsible-container pad-lft">

         <!-- ko ifnot: section.data.length -->
         <div class="afs-nodata-note">No data for this section</div>
         <!-- /ko -->
         
         <!-- ko if: section.data.length -->
         <div class="afs-report-subsection" >
             <div>
                 <div data-bind="foreach: {data: section.data, as: 'item', noChildContext: true}" class="afs-report-subsection-ite" style="padding-top: 10px;">
                     <div class="afs-block-attributes pad-btm">
                         <div>
                            <h4 style="text-transform: capitalize;" data-bind="text: item.key" class="afs-block-key"></h4>
                            <div class="afs-card-control" data-bind="if: item.card">
                                <a class="afs-report-a" data-bind="click: function(){add(item.card)}"><i class="fa fa-mail-reply"></i> {% trans "Edit" %} <span style="text-transform: capitalize;" data-bind="text:item.key"></span></a>
                            </div>        
                         </div>
                         <!-- ko ifnot: item.value -->
                         <div>
                            <div class="afs-block-value">--</div>
                        </div>
                         <!-- /ko -->

                         <!-- ko if: item.type == 'kv'-->
                         <div class="afs-block-value" data-bind="text: item.value"></div>
                         <!-- /ko --> 

                         <!-- ko if: item.type == 'href'-->
                         <div class="afs-block-value"><a data-bind="text: item.value, attr: { href: item.href }"></a></div>
                         <!-- /ko -->  

                         <!-- ko if: item.type == 'resource'-->
                         <!-- ko if: item.value -->
                         <!-- ko if: item.value && item.value.length -->
                         <!-- ko foreach: {data: item, as: 'instance', noChildContext: true}-->
                         <div data-bind="foreach: {data: instance.value.instance_details, as: 'detail', noChildContext: true}">
                            <div class="afs-block-value"><a data-bind="text: detail.display_value, attr: { href: getResourceLink(detail) }"></a></div>
                         </div>
                         <!-- /ko -->
                         <!-- /ko -->
                         <!-- ko if: item.value && !item.value.length -->
                         <!-- ko ifnot: item.value.instance_details -->
                         <div>
                            <div class="afs-block-value"><a data-bind="text: $parent.getNodeValue(item.value), attr: { href: $parent.getResourceLink(item.value) }"></a></div>
                        </div>
                         <!-- /ko -->
                         <!-- ko if: item.value.instance_details -->
                         <div data-bind="foreach: {data: item.value.instance_details, as: 'instance', noChildContext: true}">
                            <div class="afs-block-value"><a data-bind="text: instance.display_value, attr: { href: $parent.getResourceLink(instance) }"></a></div>
                         </div>
                         <!-- /ko -->
                         <!-- /ko -->
                         <!-- /ko -->
                         <!-- /ko -->
                         
                     </div>
                 </div>
             </div>
         </div>
         <!-- /ko -->
    </div>
</div>
{% endblock body %}
{% endblock report %}